!function(){var a=function(c){var b=new a.Builder;return b.pipeline.add(a.trimmer,a.stopWordFilter,a.stemmer),b.searchPipeline.add(a.stemmer),c.call(b,b),b.build()};a.version="2.1.5",a.utils={},a.utils.warn=function(a){return function(b){a.console&&console.warn&&console.warn(b)}}(this),a.utils.asString=function(a){return void 0===a||null===a?"":a.toString()},a.FieldRef=function(a,b,c){this.docRef=a,this.fieldName=b,this._stringValue=c},a.FieldRef.joiner="/",a.FieldRef.fromString=function(b){var c=b.indexOf(a.FieldRef.joiner),d,e;if(-1===c)throw"malformed field ref string";return d=b.slice(0,c),e=b.slice(c+1),new a.FieldRef(e,d,b)},a.FieldRef.prototype.toString=function(){return void 0==this._stringValue&&(this._stringValue=this.fieldName+a.FieldRef.joiner+this.docRef),this._stringValue},a.idf=function(b,d){var a=0,c,e;for(c in b)"_index"!=c&&(a+=Object.keys(b[c]).length);return e=(d-a+.5)/(a+.5),Math.log(1+Math.abs(e))},a.Token=function(a,b){this.str=a||"",this.metadata=b||{}},a.Token.prototype.toString=function(){return this.str},a.Token.prototype.update=function(a){return this.str=a(this.str,this.metadata),this},a.Token.prototype.clone=function(b){return b=b||function(a){return a},new a.Token(b(this.str,this.metadata),this.metadata)},a.tokenizer=function(c){var e,g,f,b,d,h;if(null==c||void 0==c)return[];if(Array.isArray(c))return c.map(function(b){return new a.Token(a.utils.asString(b).toLowerCase())});for(e=c.toString().trim().toLowerCase(),g=e.length,f=[],b=0,d=0;b<=g;b++)h=b-d,(e.charAt(b).match(a.tokenizer.separator)||b==g)&&(h>0&&f.push(new a.Token(e.slice(d,b),{position:[d,h],index:f.length})),d=b+1);return f},a.tokenizer.separator=/[\s\-]+/,a.Pipeline=function(){this._stack=[]},a.Pipeline.registeredFunctions=Object.create(null),a.Pipeline.registerFunction=function(b,c){c in this.registeredFunctions&&a.utils.warn("Overwriting existing registered function: "+c),b.label=c,a.Pipeline.registeredFunctions[b.label]=b},a.Pipeline.warnIfFunctionNotRegistered=function(b){b.label&&b.label in this.registeredFunctions||a.utils.warn("Function is not registered with pipeline. This may cause problems when serialising the index.\n",b)},a.Pipeline.load=function(c){var b=new a.Pipeline;return c.forEach(function(c){var d=a.Pipeline.registeredFunctions[c];if(!d)throw new Error("Cannot load unregistered function: "+c);b.add(d)}),b},a.Pipeline.prototype.add=function(){Array.prototype.slice.call(arguments).forEach(function(b){a.Pipeline.warnIfFunctionNotRegistered(b),this._stack.push(b)},this)},a.Pipeline.prototype.after=function(d,c){a.Pipeline.warnIfFunctionNotRegistered(c);var b=this._stack.indexOf(d);if(-1==b)throw new Error("Cannot find existingFn");b+=1,this._stack.splice(b,0,c)},a.Pipeline.prototype.before=function(d,b){a.Pipeline.warnIfFunctionNotRegistered(b);var c=this._stack.indexOf(d);if(-1==c)throw new Error("Cannot find existingFn");this._stack.splice(c,0,b)},a.Pipeline.prototype.remove=function(b){var a=this._stack.indexOf(b);-1!=a&&this._stack.splice(a,1)},a.Pipeline.prototype.run=function(a){for(var c=this._stack.length,b=0,d;b<c;b++)d=this._stack[b],a=a.reduce(function(c,e,f){var b=d(e,f,a);return void 0===b||""===b?c:c.concat(b)},[]);return a},a.Pipeline.prototype.runString=function(b){var c=new a.Token(b);return this.run([c]).map(function(a){return a.toString()})},a.Pipeline.prototype.reset=function(){this._stack=[]},a.Pipeline.prototype.toJSON=function(){return this._stack.map(function(b){return a.Pipeline.warnIfFunctionNotRegistered(b),b.label})},a.Vector=function(a){this._magnitude=0,this.elements=a||[]},a.Vector.prototype.positionForIndex=function(c){if(0==this.elements.length)return 0;for(var d=0,f=this.elements.length/2,e=f-d,a=Math.floor(e/2),b=this.elements[2*a];e>1&&(b<c&&(d=a),b>c&&(f=a),b!=c);)e=f-d,a=d+Math.floor(e/2),b=this.elements[2*a];return b==c?2*a:b>c?2*a:b<c?2*(a+1):void 0},a.Vector.prototype.insert=function(a,b){this.upsert(a,b,function(){throw"duplicate index"})},a.Vector.prototype.upsert=function(b,c,d){this._magnitude=0;var a=this.positionForIndex(b);this.elements[a]==b?this.elements[a+1]=d(this.elements[a+1],c):this.elements.splice(a,0,b,c)},a.Vector.prototype.magnitude=function(){var b,d,a,c;if(this._magnitude)return this._magnitude;for(b=0,d=this.elements.length,a=1;a<d;a+=2)c=this.elements[a],b+=c*c;return this._magnitude=Math.sqrt(b)},a.Vector.prototype.dot=function(j){for(var g=0,e=this.elements,f=j.elements,h=e.length,i=f.length,c=0,d=0,a=0,b=0;a<h&&b<i;)(c=e[a])<(d=f[b])?a+=2:c>d?b+=2:c==d&&(g+=e[a+1]*f[b+1],a+=2,b+=2);return g},a.Vector.prototype.similarity=function(a){return this.dot(a)/(this.magnitude()*a.magnitude())},a.Vector.prototype.toArray=function(){for(var b=new Array(this.elements.length/2),a=1,c=0;a<this.elements.length;a+=2,c++)b[c]=this.elements[a];return b},a.Vector.prototype.toJSON=function(){return this.elements},a.stemmer=function(){var f={ational:"ate",tional:"tion",enci:"ence",anci:"ance",izer:"ize",bli:"ble",alli:"al",entli:"ent",eli:"e",ousli:"ous",ization:"ize",ation:"ate",ator:"ate",alism:"al",iveness:"ive",fulness:"ful",ousness:"ous",aliti:"al",iviti:"ive",biliti:"ble",logi:"log"},m={icate:"ic",ative:"",alize:"al",iciti:"ic",ical:"ic",ful:"",ness:""},d="[aeiouy]",e="[^aeiou][^aeiouy]*",c=new RegExp("^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*"),a=new RegExp("^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*[aeiouy][aeiou]*[^aeiou][^aeiouy]*"),g=new RegExp("^([^aeiou][^aeiouy]*)?[aeiouy][aeiou]*[^aeiou][^aeiouy]*([aeiouy][aeiou]*)?$"),h=new RegExp("^([^aeiou][^aeiouy]*)?[aeiouy]"),i=/^(.+?)(ss|i)es$/,j=/^(.+?)([^s])s$/,k=/^(.+?)eed$/,l=/^(.+?)(ed|ing)$/,b=/.$/,n=/(at|bl|iz)$/,o=new RegExp("([^aeiouylsz])\\1$"),p=new RegExp("^"+e+d+"[^aeiouwxy]$"),q=/^(.+?[^aeiou])y$/,r=/^(.+?)(ational|tional|enci|anci|izer|bli|alli|entli|eli|ousli|ization|ation|ator|alism|iveness|fulness|ousness|aliti|iviti|biliti|logi)$/,s=/^(.+?)(icate|ative|alize|iciti|ical|ful|ness)$/,t=/^(.+?)(al|ance|ence|er|ic|able|ible|ant|ement|ment|ent|ou|ism|ate|iti|ous|ive|ize)$/,u=/^(.+?)(s|t)(ion)$/,v=/^(.+?)e$/,w=/ll$/,x=new RegExp("^"+e+d+"[^aeiouwxy]$"),y=function(d){var y,D,B,e,z,C,E,A;return d.length<3?d:("y"==(B=d.substr(0,1))&&(d=B.toUpperCase()+d.substr(1)),e=i,z=j,e.test(d)?d=d.replace(e,"$1$2"):z.test(d)&&(d=d.replace(z,"$1$2")),e=k,z=l,e.test(d)?(A=e.exec(d),(e=c).test(A[1])&&(e=b,d=d.replace(e,""))):z.test(d)&&(y=(A=z.exec(d))[1],(z=h).test(y)&&(C=o,E=p,(z=n).test(d=y)?d+="e":C.test(d)?(e=b,d=d.replace(e,"")):E.test(d)&&(d+="e"))),(e=q).test(d)&&(d=(y=(A=e.exec(d))[1])+"i"),(e=r).test(d)&&(y=(A=e.exec(d))[1],D=A[2],(e=c).test(y)&&(d=y+f[D])),(e=s).test(d)&&(y=(A=e.exec(d))[1],D=A[2],(e=c).test(y)&&(d=y+m[D])),(e=t,z=u,e.test(d))?(y=(A=e.exec(d))[1],(e=a).test(y)&&(d=y)):z.test(d)&&(y=(A=z.exec(d))[1]+A[2],(z=a).test(y)&&(d=y)),(e=v).test(d)&&(y=(A=e.exec(d))[1],z=g,C=x,((e=a).test(y)||z.test(y)&&!C.test(y))&&(d=y)),e=w,z=a,e.test(d)&&z.test(d)&&(e=b,d=d.replace(e,"")),"y"==B&&(d=B.toLowerCase()+d.substr(1)),d)};return function(a){return a.update(y)}}(),a.Pipeline.registerFunction(a.stemmer,"stemmer"),a.generateStopWordFilter=function(a){var b=a.reduce(function(a,b){return a[b]=b,a},{});return function(a){if(a&&b[a.toString()]!==a.toString())return a}},a.stopWordFilter=a.generateStopWordFilter(["a","able","about","across","after","all","almost","also","am","among","an","and","any","are","as","at","be","because","been","but","by","can","cannot","could","dear","did","do","does","either","else","ever","every","for","from","get","got","had","has","have","he","her","hers","him","his","how","however","i","if","in","into","is","it","its","just","least","let","like","likely","may","me","might","most","must","my","neither","no","nor","not","of","off","often","on","only","or","other","our","own","rather","said","say","says","she","should","since","so","some","than","that","the","their","them","then","there","these","they","this","tis","to","too","twas","us","wants","was","we","were","what","when","where","which","while","who","whom","why","will","with","would","yet","you","your"]),a.Pipeline.registerFunction(a.stopWordFilter,"stopWordFilter"),a.trimmer=function(a){return a.update(function(a){return a.replace(/^\W+/,"").replace(/\W+$/,"")})},a.Pipeline.registerFunction(a.trimmer,"trimmer"),a.TokenSet=function(){this.final=!1,this.edges={},this.id=a.TokenSet._nextId,a.TokenSet._nextId+=1},a.TokenSet._nextId=1,a.TokenSet.fromArray=function(d){for(var b=new a.TokenSet.Builder,c=0,e=d.length;c<e;c++)b.insert(d[c]);return b.finish(),b.root},a.TokenSet.fromClause=function(b){return"editDistance"in b?a.TokenSet.fromFuzzyString(b.term,b.editDistance):a.TokenSet.fromString(b.term)},a.TokenSet.fromFuzzyString=function(n,l){for(var k=new a.TokenSet,c=[{node:k,editsRemaining:l,str:n}],b,f,e,d,i,h,g,m,j;c.length;)b=c.pop(),b.str.length>0&&((d=b.str.charAt(0))in b.node.edges?f=b.node.edges[d]:(f=new a.TokenSet,b.node.edges[d]=f),1==b.str.length?f.final=!0:c.push({node:f,editsRemaining:b.editsRemaining,str:b.str.slice(1)})),b.editsRemaining>0&&b.str.length>1&&(d=b.str.charAt(1),d in b.node.edges?e=b.node.edges[d]:(e=new a.TokenSet,b.node.edges[d]=e),b.str.length<=2?e.final=!0:c.push({node:e,editsRemaining:b.editsRemaining-1,str:b.str.slice(2)})),(b.editsRemaining>0&&1==b.str.length&&(b.node.final=!0),b.editsRemaining>0&&b.str.length>=1)&&("*"in b.node.edges?i=b.node.edges["*"]:(i=new a.TokenSet,b.node.edges["*"]=i),1==b.str.length?i.final=!0:c.push({node:i,editsRemaining:b.editsRemaining-1,str:b.str.slice(1)})),b.editsRemaining>0&&("*"in b.node.edges?h=b.node.edges["*"]:(h=new a.TokenSet,b.node.edges["*"]=h),0==b.str.length?h.final=!0:c.push({node:h,editsRemaining:b.editsRemaining-1,str:b.str})),b.editsRemaining>0&&b.str.length>1&&(m=b.str.charAt(0),j=b.str.charAt(1),j in b.node.edges?g=b.node.edges[j]:(g=new a.TokenSet,b.node.edges[j]=g),1==b.str.length?g.final=!0:c.push({node:g,editsRemaining:b.editsRemaining-1,str:m+b.str.slice(2)}));return k},a.TokenSet.fromString=function(h){for(var b=new a.TokenSet,j=b,f=!1,c=0,g=h.length,d,i,e;c<g;c++)d=h[c],i=c==g-1,"*"==d?(f=!0,b.edges[d]=b,b.final=i):(e=new a.TokenSet,e.final=i,b.edges[d]=e,b=e,f&&(b.edges["*"]=j));return j},a.TokenSet.prototype.toArray=function(){for(var d=[],b=[{prefix:"",node:this}],a,e,g,c,f;b.length;){a=b.pop(),e=Object.keys(a.node.edges),g=e.length,a.node.final&&d.push(a.prefix);for(c=0;c<g;c++)f=e[c],b.push({prefix:a.prefix.concat(f),node:a.node.edges[f]})}return d},a.TokenSet.prototype.toString=function(){var a,c,e,b,d;if(this._str)return this._str;for(a=this.final?"1":"0",c=Object.keys(this.edges).sort(),e=c.length,b=0;b<e;b++)d=c[b],a=a+d+this.edges[d].id;return a},a.TokenSet.prototype.intersect=function(q){for(var l=new a.TokenSet,b=void 0,e=[{qNode:q,output:l,node:this}],k,o,j,p,h,g,f,d,m,i,n,c;e.length;){b=e.pop();for(k=Object.keys(b.qNode.edges),o=k.length,j=Object.keys(b.node.edges),p=j.length,h=0;h<o;h++)for(g=k[h],f=0;f<p;f++)d=j[f],(d==g||"*"==g)&&(m=b.node.edges[d],i=b.qNode.edges[g],n=m.final&&i.final,c=void 0,d in b.output.edges?(c=b.output.edges[d]).final=c.final||n:((c=new a.TokenSet).final=n,b.output.edges[d]=c),e.push({qNode:i,output:c,node:m}))}return l},a.TokenSet.Builder=function(){this.previousWord="",this.root=new a.TokenSet,this.uncheckedNodes=[],this.minimizedNodes={}},a.TokenSet.Builder.prototype.insert=function(c){var d,e=0,b,f,g;if(c<this.previousWord)throw new Error("Out of order word insertion");for(b=0;b<c.length&&b<this.previousWord.length&&c[b]==this.previousWord[b];b++)e++;this.minimize(e),d=0==this.uncheckedNodes.length?this.root:this.uncheckedNodes[this.uncheckedNodes.length-1].child;for(b=e;b<c.length;b++)f=new a.TokenSet,g=c[b],d.edges[g]=f,this.uncheckedNodes.push({parent:d,char:g,child:f}),d=f;d.final=!0,this.previousWord=c},a.TokenSet.Builder.prototype.finish=function(){this.minimize(0)},a.TokenSet.Builder.prototype.minimize=function(d){for(var c=this.uncheckedNodes.length-1,a,b;c>=d;c--)a=this.uncheckedNodes[c],b=a.child.toString(),b in this.minimizedNodes?a.parent.edges[a.char]=this.minimizedNodes[b]:(a.child._str=b,this.minimizedNodes[b]=a.child),this.uncheckedNodes.pop()},a.Index=function(a){this.invertedIndex=a.invertedIndex,this.fieldVectors=a.fieldVectors,this.tokenSet=a.tokenSet,this.fields=a.fields,this.pipeline=a.pipeline},a.Index.prototype.search=function(b){return this.query(function(c){new a.QueryParser(b,c).parse()})},a.Index.prototype.query=function(J){var h=new a.Query(this.fields),e=Object.create(null),i=Object.create(null),q=Object.create(null),b,n,o,I,G,s,m,g,r,F,j,c,E,t,u,p,w,x,y,z,A,B,C,d,l,f,k,H,v,D;J.call(h,h);for(d=0;d<h.clauses.length;d++){b=h.clauses[d],n=null,n=b.usePipeline?this.pipeline.runString(b.term):[b.term];for(o=0;o<n.length;o++){I=n[o],b.term=I;for(G=a.TokenSet.fromClause(b),s=this.tokenSet.intersect(G).toArray(),m=0;m<s.length;m++)for(g=s[m],r=this.invertedIndex[g],F=r._index,j=0;j<b.fields.length;j++)if(c=b.fields[j],E=r[c],t=Object.keys(E),u=g+"/"+c,void 0===i[c]&&(i[c]=new a.Vector),i[c].upsert(F,1*b.boost,function(a,b){return a+b}),!q[u]){for(p=0;p<t.length;p++)x=t[p],y=new a.FieldRef(x,c),z=E[x],void 0===(w=e[y])?e[y]=new a.MatchData(g,c,z):w.add(g,c,z);q[u]=!0}}}for(A=Object.keys(e),B=[],C=Object.create(null),d=0;d<A.length;d++)f=a.FieldRef.fromString(A[d]),k=f.docRef,H=this.fieldVectors[f],v=i[f.fieldName].similarity(H),void 0!==(l=C[k])?(l.score+=v,l.matchData.combine(e[f])):(D={ref:k,score:v,matchData:e[f]},C[k]=D,B.push(D));return B.sort(function(a,b){return b.score-a.score})},a.Index.prototype.toJSON=function(){var b=Object.keys(this.invertedIndex).sort().map(function(a){return[a,this.invertedIndex[a]]},this),c=Object.keys(this.fieldVectors).map(function(a){return[a,this.fieldVectors[a].toJSON()]},this);return{version:a.version,fields:this.fields,fieldVectors:c,invertedIndex:b,pipeline:this.pipeline.toJSON()}},a.Index.load=function(d){var c={},g={},k=d.fieldVectors,h={},i=d.invertedIndex,f=new a.TokenSet.Builder,l=a.Pipeline.load(d.pipeline),n,m,b,e,j,o;d.version!=a.version&&a.utils.warn("Version mismatch when loading serialised index. Current version of lunr '"+a.version+"' does not match serialized index '"+d.version+"'");for(b=0;b<k.length;b++)n=(e=k[b])[0],m=e[1],g[n]=new a.Vector(m);for(b=0;b<i.length;b++)e=i[b],j=e[0],o=e[1],f.insert(j),h[j]=o;return f.finish(),c.fields=d.fields,c.fieldVectors=g,c.invertedIndex=h,c.tokenSet=f.root,c.pipeline=l,new a.Index(c)},a.Builder=function(){this._ref="id",this._fields=[],this.invertedIndex=Object.create(null),this.fieldTermFrequencies={},this.fieldLengths={},this.tokenizer=a.tokenizer,this.pipeline=new a.Pipeline,this.searchPipeline=new a.Pipeline,this.documentCount=0,this._b=.75,this._k1=1.2,this.termIndex=0,this.metadataWhitelist=[]},a.Builder.prototype.ref=function(a){this._ref=a},a.Builder.prototype.field=function(a){this._fields.push(a)},a.Builder.prototype.b=function(a){this._b=a<0?0:a>1?1:a},a.Builder.prototype.k1=function(a){this._k1=a},a.Builder.prototype.add=function(n){var d=n[this._ref],k,c,p,o,i,j,e,l,b,m,g,h,f,q;this.documentCount+=1;for(k=0;k<this._fields.length;k++){c=this._fields[k],p=n[c],o=this.tokenizer(p),i=this.pipeline.run(o),j=new a.FieldRef(d,c),e=Object.create(null),this.fieldTermFrequencies[j]=e,this.fieldLengths[j]=0,this.fieldLengths[j]+=i.length;for(l=0;l<i.length;l++){if(b=i[l],void 0==e[b]&&(e[b]=0),e[b]+=1,void 0==this.invertedIndex[b]){m=Object.create(null),m._index=this.termIndex,this.termIndex+=1;for(g=0;g<this._fields.length;g++)m[this._fields[g]]=Object.create(null);this.invertedIndex[b]=m}void 0==this.invertedIndex[b][c][d]&&(this.invertedIndex[b][c][d]=Object.create(null));for(h=0;h<this.metadataWhitelist.length;h++)f=this.metadataWhitelist[h],q=b.metadata[f],void 0==this.invertedIndex[b][c][d][f]&&(this.invertedIndex[b][c][d][f]=[]),this.invertedIndex[b][c][d][f].push(q)}}},a.Builder.prototype.calculateAverageFieldLengths=function(){for(var g=Object.keys(this.fieldLengths),h=g.length,d={},e={},c=0,f,b;c<h;c++)f=a.FieldRef.fromString(g[c]),e[b=f.fieldName]||(e[b]=0),e[b]+=1,d[b]||(d[b]=0),d[b]+=this.fieldLengths[f];for(c=0;c<this._fields.length;c++)b=this._fields[c],d[b]=d[b]/e[b];this.averageFieldLength=d},a.Builder.prototype.createFieldVectors=function(){for(var o={},n=Object.keys(this.fieldTermFrequencies),s=n.length,e=Object.create(null),f=0,c,r,q,j,k,l,p,g,d,m,i,b,h,t;f<s;f++){for(c=a.FieldRef.fromString(n[f]),r=c.fieldName,q=this.fieldLengths[c],j=new a.Vector,k=this.fieldTermFrequencies[c],l=Object.keys(k),p=l.length,g=0;g<p;g++)b=l[g],h=k[b],t=this.invertedIndex[b]._index,void 0===e[b]?(d=a.idf(this.invertedIndex[b],this.documentCount),e[b]=d):d=e[b],m=d*((this._k1+1)*h)/(this._k1*(1-this._b+this._b*(q/this.averageFieldLength[r]))+h),i=Math.round(1e3*m)/1e3,j.insert(t,i);o[c]=j}this.fieldVectors=o},a.Builder.prototype.createTokenSet=function(){this.tokenSet=a.TokenSet.fromArray(Object.keys(this.invertedIndex).sort())},a.Builder.prototype.build=function(){return this.calculateAverageFieldLengths(),this.createFieldVectors(),this.createTokenSet(),new a.Index({invertedIndex:this.invertedIndex,fieldVectors:this.fieldVectors,tokenSet:this.tokenSet,fields:this._fields,pipeline:this.searchPipeline})},a.Builder.prototype.use=function(b){var a=Array.prototype.slice.call(arguments,1);a.unshift(this),b.apply(this,a)},a.MatchData=function(b,g,c){for(var d=Object.create(null),e=Object.keys(c),a=0,f;a<e.length;a++)f=e[a],d[f]=c[f].slice();this.metadata=Object.create(null),this.metadata[b]=Object.create(null),this.metadata[b][g]=d},a.MatchData.prototype.combine=function(d){for(var h=Object.keys(d.metadata),e=0,a,i,f,b,j,g,c;e<h.length;e++){a=h[e],i=Object.keys(d.metadata[a]),void 0==this.metadata[a]&&(this.metadata[a]=Object.create(null));for(f=0;f<i.length;f++){b=i[f],j=Object.keys(d.metadata[a][b]),void 0==this.metadata[a][b]&&(this.metadata[a][b]=Object.create(null));for(g=0;g<j.length;g++)c=j[g],void 0==this.metadata[a][b][c]?this.metadata[a][b][c]=d.metadata[a][b][c]:this.metadata[a][b][c]=this.metadata[a][b][c].concat(d.metadata[a][b][c])}}},a.MatchData.prototype.add=function(a,b,d){var f,e,c;if(!(a in this.metadata))return this.metadata[a]=Object.create(null),void(this.metadata[a][b]=d);if(b in this.metadata[a])for(f=Object.keys(d),e=0;e<f.length;e++)c=f[e],c in this.metadata[a][b]?this.metadata[a][b][c]=this.metadata[a][b][c].concat(d[c]):this.metadata[a][b][c]=d[c];else this.metadata[a][b]=d},a.Query=function(a){this.clauses=[],this.allFields=a},a.Query.wildcard=new String("*"),a.Query.wildcard.NONE=0,a.Query.wildcard.LEADING=1,a.Query.wildcard.TRAILING=2,a.Query.prototype.clause=function(b){return"fields"in b||(b.fields=this.allFields),"boost"in b||(b.boost=1),"usePipeline"in b||(b.usePipeline=!0),"wildcard"in b||(b.wildcard=a.Query.wildcard.NONE),b.wildcard&a.Query.wildcard.LEADING&&b.term.charAt(0)!=a.Query.wildcard&&(b.term="*"+b.term),b.wildcard&a.Query.wildcard.TRAILING&&b.term.slice(-1)!=a.Query.wildcard&&(b.term=b.term+"*"),this.clauses.push(b),this},a.Query.prototype.term=function(b,c){var a=c||{};return a.term=b,this.clause(a),this},a.QueryParseError=function(a,b,c){this.name="QueryParseError",this.message=a,this.start=b,this.end=c},a.QueryParseError.prototype=new Error,a.QueryLexer=function(a){this.lexemes=[],this.str=a,this.length=a.length,this.pos=0,this.start=0,this.escapeCharPositions=[]},a.QueryLexer.prototype.run=function(){for(var b=a.QueryLexer.lexText;b;)b=b(this)},a.QueryLexer.prototype.sliceString=function(){for(var a=[],b=this.start,c=this.pos,d=0;d<this.escapeCharPositions.length;d++)c=this.escapeCharPositions[d],a.push(this.str.slice(b,c)),b=c+1;return a.push(this.str.slice(b,this.pos)),this.escapeCharPositions.length=0,a.join("")},a.QueryLexer.prototype.emit=function(a){this.lexemes.push({type:a,str:this.sliceString(),start:this.start,end:this.pos}),this.start=this.pos},a.QueryLexer.prototype.escapeCharacter=function(){this.escapeCharPositions.push(this.pos-1),this.pos+=1},a.QueryLexer.prototype.next=function(){if(this.pos>=this.length)return a.QueryLexer.EOS;var b=this.str.charAt(this.pos);return this.pos+=1,b},a.QueryLexer.prototype.width=function(){return this.pos-this.start},a.QueryLexer.prototype.ignore=function(){this.start==this.pos&&(this.pos+=1),this.start=this.pos},a.QueryLexer.prototype.backup=function(){this.pos-=1},a.QueryLexer.prototype.acceptDigitRun=function(){var c,b;do b=(c=this.next()).charCodeAt(0);while(b>47&&b<58)c!=a.QueryLexer.EOS&&this.backup()},a.QueryLexer.prototype.more=function(){return this.pos<this.length},a.QueryLexer.EOS="EOS",a.QueryLexer.FIELD="FIELD",a.QueryLexer.TERM="TERM",a.QueryLexer.EDIT_DISTANCE="EDIT_DISTANCE",a.QueryLexer.BOOST="BOOST",a.QueryLexer.lexField=function(b){return b.backup(),b.emit(a.QueryLexer.FIELD),b.ignore(),a.QueryLexer.lexText},a.QueryLexer.lexTerm=function(b){if(b.width()>1&&(b.backup(),b.emit(a.QueryLexer.TERM)),b.ignore(),b.more())return a.QueryLexer.lexText},a.QueryLexer.lexEditDistance=function(b){return b.ignore(),b.acceptDigitRun(),b.emit(a.QueryLexer.EDIT_DISTANCE),a.QueryLexer.lexText},a.QueryLexer.lexBoost=function(b){return b.ignore(),b.acceptDigitRun(),b.emit(a.QueryLexer.BOOST),a.QueryLexer.lexText},a.QueryLexer.lexEOS=function(b){b.width()>0&&b.emit(a.QueryLexer.TERM)},a.QueryLexer.termSeparator=a.tokenizer.separator,a.QueryLexer.lexText=function(b){for(;;){var c=b.next();if(c==a.QueryLexer.EOS)return a.QueryLexer.lexEOS;if(92!=c.charCodeAt(0)){{if(":"==c)return a.QueryLexer.lexField;if("~"==c)return b.backup(),b.width()>0&&b.emit(a.QueryLexer.TERM),a.QueryLexer.lexEditDistance;if("^"==c)return b.backup(),b.width()>0&&b.emit(a.QueryLexer.TERM),a.QueryLexer.lexBoost;if(c.match(a.QueryLexer.termSeparator))return a.QueryLexer.lexTerm}}else b.escapeCharacter()}},a.QueryParser=function(b,c){this.lexer=new a.QueryLexer(b),this.query=c,this.currentClause={},this.lexemeIdx=0},a.QueryParser.prototype.parse=function(){this.lexer.run(),this.lexemes=this.lexer.lexemes;for(var b=a.QueryParser.parseFieldOrTerm;b;)b=b(this);return this.query},a.QueryParser.prototype.peekLexeme=function(){return this.lexemes[this.lexemeIdx]},a.QueryParser.prototype.consumeLexeme=function(){var a=this.peekLexeme();return this.lexemeIdx+=1,a},a.QueryParser.prototype.nextClause=function(){var a=this.currentClause;this.query.clause(a),this.currentClause={}},a.QueryParser.parseFieldOrTerm=function(d){var b=d.peekLexeme(),c;if(void 0!=b)switch(b.type){case a.QueryLexer.FIELD:return a.QueryParser.parseField;case a.QueryLexer.TERM:return a.QueryParser.parseTerm;default:throw c="expected either a field or a term, found "+b.type,b.str.length>=1&&(c+=" with value '"+b.str+"'"),new a.QueryParseError(c,b.start,b.end)}},a.QueryParser.parseField=function(c){var b=c.consumeLexeme(),f,d,e;if(void 0!=b){if(-1==c.query.allFields.indexOf(b.str))throw f=c.query.allFields.map(function(a){return"'"+a+"'"}).join(", "),d="unrecognised field '"+b.str+"', possible fields: "+f,new a.QueryParseError(d,b.start,b.end);if(c.currentClause.fields=[b.str],e=c.peekLexeme(),void 0==e)throw d="expecting term, found nothing",new a.QueryParseError(d,b.start,b.end);switch(e.type){case a.QueryLexer.TERM:return a.QueryParser.parseTerm;default:throw d="expecting term, found '"+e.type+"'",new a.QueryParseError(d,e.start,e.end)}}},a.QueryParser.parseTerm=function(b){var d=b.consumeLexeme(),c,e;if(void 0!=d)if(b.currentClause.term=d.str.toLowerCase(),-1!=d.str.indexOf("*")&&(b.currentClause.usePipeline=!1),c=b.peekLexeme(),void 0!=c)switch(c.type){case a.QueryLexer.TERM:return b.nextClause(),a.QueryParser.parseTerm;case a.QueryLexer.FIELD:return b.nextClause(),a.QueryParser.parseField;case a.QueryLexer.EDIT_DISTANCE:return a.QueryParser.parseEditDistance;case a.QueryLexer.BOOST:return a.QueryParser.parseBoost;default:throw e="Unexpected lexeme type '"+c.type+"'",new a.QueryParseError(e,c.start,c.end)}else b.nextClause()},a.QueryParser.parseEditDistance=function(b){var d=b.consumeLexeme(),f,c,e;if(void 0!=d){if(f=parseInt(d.str,10),isNaN(f))throw e="edit distance must be numeric",new a.QueryParseError(e,d.start,d.end);if(b.currentClause.editDistance=f,c=b.peekLexeme(),void 0!=c)switch(c.type){case a.QueryLexer.TERM:return b.nextClause(),a.QueryParser.parseTerm;case a.QueryLexer.FIELD:return b.nextClause(),a.QueryParser.parseField;case a.QueryLexer.EDIT_DISTANCE:return a.QueryParser.parseEditDistance;case a.QueryLexer.BOOST:return a.QueryParser.parseBoost;default:throw e="Unexpected lexeme type '"+c.type+"'",new a.QueryParseError(e,c.start,c.end)}else b.nextClause()}},a.QueryParser.parseBoost=function(b){var d=b.consumeLexeme(),f,c,e;if(void 0!=d){if(f=parseInt(d.str,10),isNaN(f))throw e="boost must be numeric",new a.QueryParseError(e,d.start,d.end);if(b.currentClause.boost=f,c=b.peekLexeme(),void 0!=c)switch(c.type){case a.QueryLexer.TERM:return b.nextClause(),a.QueryParser.parseTerm;case a.QueryLexer.FIELD:return b.nextClause(),a.QueryParser.parseField;case a.QueryLexer.EDIT_DISTANCE:return a.QueryParser.parseEditDistance;case a.QueryLexer.BOOST:return a.QueryParser.parseBoost;default:throw e="Unexpected lexeme type '"+c.type+"'",new a.QueryParseError(e,c.start,c.end)}else b.nextClause()}},function(b,a){"function"==typeof define&&define.amd?define(a):"object"==typeof exports?module.exports=a():b.lunr=a()}(this,function(){return a})}();var searchIndex,$results,pagesIndex;function initSearchIndex(){fetch("/index.json").then(a=>a.json()).then(a=>{pagesIndex=a,searchIndex=lunr(function(){this.field("title"),this.field("categories"),this.field("content"),this.ref("href");for(var b=0;b<a.length;++b)this.add(a[b]);initUI()})})}function initUI(){$results=$(".posts"),$("#search").keyup(function(){$results.empty();var a=$(this).val();renderResults(searchSite(a))})}function searchSite(a){return searchIndex.query(function(b){b.term(a,{usePipeline:!0,boost:100}),b.term(a,{usePipeline:!1,boost:10,wildcard:lunr.Query.wildcard.TRAILING})}).map(function(a){return pagesIndex.filter(function(b){return b.href===a.ref})[0]})}function renderResults(a){if(!a.length)return;a.slice(0,10).forEach(function(a){var b=$("<li>");b.append($("<a>",{href:a.href,text:"» "+a.title})),b.append($("<p/>",{text:a.content.slice(0,100)+"..."})),$results.append(b)})}document.addEventListener("DOMContentLoaded",function(a){initSearchIndex()})